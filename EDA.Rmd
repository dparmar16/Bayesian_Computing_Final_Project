---
title: "EDA"
author: "Group"
date: "11/22/2021"
output: html_document
---

```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
# knitr::opts_chunk$set(warning = F, results = 'markup', message = F)
knitr::opts_chunk$set(warning = F, results = 'hide', message = F)
# knitr::opts_chunk$set(include = F)
# knitr::opts_chunk$set(echo = TRUE)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

```{r basic, include=F}
# use this function to conveniently load libraries and work smoothly with knitting
# can add quietly=T option to the require() function
loadPkg = function(pkg, character.only = FALSE) { 
  if (!character.only) { pkg <- as.character(substitute(pkg)) }
  pkg <- ifelse(!character.only, as.character(substitute(pkg)) , pkg)  
  if (!require(pkg,character.only=T, quietly =T)) {  install.packages(substitute(pkg),dep=T); if(!require(pkg,character.only=T)) stop("Package not found") } 
}
loadPkg(knitr)

# unload/detact package when done using it
unloadPkg = function(pkg, character.only = FALSE) { 
  if(!character.only) { pkg <- as.character(substitute(pkg)) } 
  search_item <- paste("package", pkg,sep = ":") 
  while(search_item %in% search()) { detach(search_item, unload = TRUE, character.only = TRUE) } 
}

```



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyr)
#Clenaing the data
data <- read.csv("Data/uk_used_cars.csv") # read the data in 
print('There are 108540 rows before cleaning')
nrow(data) # 108540 before cleaning
data<- data[!(data$year== 2060),] # removed car sales from 2060
data<- data[rowSums(is.na(data)) == 0,] # removed NA values

                                                          ###########################################
                                                          ### below are additional cleaning steps ###
                                                          ###########################################


print('Year Count on Raw Data')
table(data$year) # create table to show count of years that should be deleted
table_year <- as.data.frame(table(data$year))
#pie(table(data$year), main = 'Raw Data Counts on Car Years') # created visualization for car year counts
ggplot(table_year, aes(x = "", y = Freq, fill = Var1)) +
  ggtitle('Raw Data Counts on Car Years') +
  geom_col() +
  coord_polar(theta = "y")
data<-data[!(data$year < 2008),] # removed years less than 


print('Fuel Type count on Raw Data')
table(data$fuelType) # created table for fuel types variable
table_fuelType <- as.data.frame(table(data$fuelType))
#pie(table(data$fuelType), main = 'Raw Data Counts on Fuel Types') # created visualization for fuel types
ggplot(table_fuelType, aes(x = "", y = Freq, fill = Var1)) +
  ggtitle('Raw Data Counts on Car Years') +
  geom_col() +
  coord_polar(theta = "y")
data <- data[!(data$fuelType == "Electric" | data$fuelType == "Other"),] # remove electric and other from fuel types


print('Transmission types count on Raw Data')
table(data$transmission)
table_transmission <- as.data.frame(table(data$transmission))
#pie(table(data$transmission), main= 'Raw Data Counts on Transmission types')
ggplot(table_transmission, aes(x = "", y = Freq, fill = Var1)) +
  ggtitle('Raw Data Counts on Transmission Types') +
  geom_col() +
  coord_polar(theta = "y")
data <- data[!(data$transmission == "Other"),]

# review of clean data
print('Number of rows after cleaning')
nrow(data) # now there are 98439 rows after cleaning 
x <- (1-(98439/108540))*100 # original data loss from cleaning calculation
print('Total percentage of rows removed from the original data is')
x # 9.31% of the original data was removed 
head(data)
```

For this project, the dataset of [100,000 used car sales in the United Kingdom] (https://www.kaggle.com/adityadesai13/used-car-dataset-ford-and-mercedes?select=bmw.csv) was analyzed. Originally there were 9 total variables with 108540 rows. The variable of 'model' was dropped from the analysis as there were too many classes to build a model around it. The multiple csv from Kaggle were compiled and identified with a new variable 'Car.Make'. The dependent variable was 'price'. The four categorical independent variables were 'year', 'transmission', 'fuelType', and 'Car.Make'. the four quantitative independent variables were 'mileage', 'tax', 'mpg' and 'engineSize'. One-hot encoding was applied to the categorical data and the final dataframe had a total of 32 columns. Outliers were kept in the analysis as the researched wanted to avoid class imbalance for the Car.Make categories. 

The following steps were taken as part of data cleaning. All NA values were removed. Next no years were included from before 2008 and after 2020. 'Electric' and 'Other' were removed from the fuel type variable. 'Other' was removed from the transmission type. These classes were removed as they had no or very few data points of interest. The final dataframe removed 9.31% if the original data. the final dataframe had 98439 rows. 


```{r}
# get summary stats for price
summary(data$price)
```
The summary Statistics indicate a right skew in the data as the median is less than the mean. Normality should be assessed on the price variable and a proper transformation should be applied. 

```{r}
set.seed(42)
#non normal data
ggplot(data=data, aes(price)) + 
  geom_histogram( 
                 col="blue", 
                 fill="#00aaaa", 
                 alpha = .7) + # opacity
  labs(title="Histogram for Price") +
  labs(x="Price (£)", y="Frequency") 

qqnorm(data$price, main="Q-Q plot of dataset") 
qqline(data$price)
ks.test(data$price, "pnorm")

#box cox transformation
library(forecast)
lambda = BoxCox.lambda(data$price) # the data recieved a lambda of -0.128 so a new variable was created 
data$clean_price = BoxCox(data$price,lambda) # apply the proper transformation to normalize the price data

#normal data
ggplot(data=data, aes(clean_price)) + 
  geom_histogram( 
                 col="blue", 
                 fill="#00aaaa", 
                 alpha = .7) + # opacity
  labs(title="Histogram for log transformed Price")+
  labs(x="Price (£)", y="Frequency") 
qqnorm(data$clean_price, main="Q-Q plot of log transformed dataset") 
qqline(data$clean_price)
ks.test(data$clean_price, "pnorm")
```

The price data appeared very skewed to the right from the histogram. The Q-Q plot confirmed this assement as by the 2nd and 4th theoretical quantile, the data appeared to drastically increase which indicated not normally distributed data. 



```{r}
library(ggplot2)
dat <-as.data.frame(table(data$Car.Make)) # two zero found in table and turned it into a dataframe
dat[dat==0] <- NA # turned the zeros to NA values
data2<-dat[complete.cases(dat),] # removed the NA values
data2 <- data2[(order(-data2$Freq)),] # ordered the dataframe in descending order 
data2 #printed dataframe to check



# still not sure why this is happening
#ggplot(data, aes(x = Car.Make))
#barplot(data2$Freq, names.arg = data2$Var1,xlab="Types of Cars", ylab="Count of Cars", main ='Types of Cars Count')




ggplot(data, aes(x=data$Car.Make))+
  geom_bar(width=0.7, fill="steelblue")+
scale_x_discrete(labels = abbreviate)+
  labs(title = "Car Make Distribution plot")+
  theme_minimal()

```
The most popular car markers were Ford. Vlks, and Vxhl. The least popular car makers were Hynd, Skod, and Toyota. 

```{r}
ggplot(data, aes(x=transmission))+
  geom_bar(width=0.7, fill="steelblue")+
  labs(title = "Car Transmission Distribution plot")+
  theme_minimal()
```
Manual appeared to be the most common. This was then followed by Semi-Auto adn the Automatic. 

```{r}
ggplot(data, aes(x=fuelType))+
  geom_bar(width=0.7, fill="steelblue")+
  labs(title = "Car Fuel Type Distribution plot")+
  theme_minimal()

```

```{r}
ggplot(data, aes(x=Car.Make, y=price, color=Car.Make)) +
  geom_boxplot()+
  scale_x_discrete(labels = abbreviate)+
  labs(title = "Price Box Plot Per Car Make")+
  theme_minimal()

```

```{r}
anovaRes = aov(price ~ Car.Make, data=data)
names(anovaRes)
summary(anovaRes)
```

```{r}
tukeyAoV <- TukeyHSD(anovaRes)
tukeyAoV
```


```{r}
ggplot(data, aes(x=fuelType, y=tax, color=fuelType)) +
  geom_boxplot()+
  scale_x_discrete(labels = abbreviate)+
  labs(title = "Tax Box Plot Per Car Make")+
  theme_minimal()

```

```{r}
anovaRes = aov(price ~ fuelType, data=data)
names(anovaRes)
summary(anovaRes)
```


```{r}
ggplot(data, aes(x=Car.Make, y=mileage, color=Car.Make)) +
  geom_boxplot()+
  scale_x_discrete(labels = abbreviate)+
  labs(title = "MileageBox Plot Per Car Make")+
  theme_minimal()

```

```{r}
ggplot(data, aes(x=Car.Make, y=mpg, color=Car.Make)) +
  geom_boxplot()+
  scale_x_discrete(labels = abbreviate)+
  labs(title = "MPG Box Plot Per Car Make")+
  theme_minimal()


```

```{r}
library(dplyr)
data %>% 
  group_by(Car.Make) %>%
  summarise_at(vars(price), list(mean = mean))

```


```{r}
# read in linear model data 
data_df <- read.csv("/Users/jakelieberfarb/Desktop/college/Grad (2021-2022)/Bayesian DS/Project/Bayesian_Computing_Final_Project/Linear_model_data.csv")
drop <- c("X") #removed 
data_df = data_df[,!(names(data_df) %in% drop)]

# check for Multicollinearity 
# create correlation plot of data 
# subset categorical data and quantiative data to check for correlation between price
library(ggcorrplot)
#loadPkg(ggcorrplot)
data_new_quant <- subset(data_df, select = c('price','mileage','tax','mpg','engineSize'))
corr_quant <- round(cor(data_new_quant), 1)
p.mat_quant <- cor_pmat(corr_quant, method = 'pearson')
#ggcorrplot(corr_quant, hc.order=TRUE,lab = TRUE, p.mat = p.mat_quant)+ labs(title = "Correlation Plot of Quantiative data")
ggcorrplot(corr_quant, hc.order=TRUE,lab = TRUE)+ labs(title = "Correlation Plot of Quantiative data")

# categorical data correlation plot 
data_clean_cat <- subset(data_df, select = c('year_2008','year_2009','year_2010','year_2011','year_2012','year_2013',
                                        'year_2014','year_2015','year_2016','year_2017','year_2018','year_2019','year_2020',
                                        'transmission_Automatic','transmission_Manual','transmission_Semi.Auto',
                                        'fuelType_Diesel','fuelType_Hybrid','fuelType_Petrol','Car.Make_Audi','Car.Make_BMW',                         'Car.Make_Ford','Car.Make_Hyundai','Car.Make_Mercedes','Car.Make_Skoda','Car.Make_Toyota','Car.Make_Vauxhall','Car.Make_Volkswagen'))
# make categorical data numeric
data_clean_cat<- as.data.frame(lapply(data_clean_cat, as.numeric))
corr_cat <- round(cor(data_clean_cat), 2) 
p.mat_cat <- cor_pmat(corr_cat, method = 'spearman') # use Spearman correlation for large dataset of categorical features
ggcorrplot(corr_cat,p.mat=p.mat_cat, lab = TRUE) + labs(title = "Correlation Plot of Categorical data")
# it appears that only fuelType_Petrol and fuelType_Diesel  are highly correlated with each other at -.94 so they were dropped from the data frame


```

```{r}
#check correlation of categorical data with price 
loadPkg(ltm)
print('the Point-Biserial Correlation for price and year_2008 is' )
biserial.cor(data_df$price, data_df$year_2008, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2008 is' )
biserial.cor(data_df$price, data_df$year_2009, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2009 is' )
biserial.cor(data_df$price, data_df$year_2010, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2010 is' )
biserial.cor(data_df$price, data_df$year_2011, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2011 is' )
biserial.cor(data_df$price, data_df$year_2012, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2012 is' )
biserial.cor(data_df$price, data_df$year_2013, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2013 is' )
biserial.cor(data_df$price, data_df$year_2014, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2014 is' )
biserial.cor(data_df$price, data_df$year_2015, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2015 is' )
biserial.cor(data_df$price, data_df$year_2016, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2016 is' )
biserial.cor(data_df$price, data_df$year_2017, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2017 is' )
biserial.cor(data_df$price, data_df$year_2018, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2018 is' )
biserial.cor(data_df$price, data_df$year_2019, use = c("all.obs"))
print('the Point-Biserial Correlation for price and year_2019 is' )
biserial.cor(data_df$price, data_df$year_2020, use = c("all.obs"))
print('the Point-Biserial Correlation for price and transmission_Automatic is' )
biserial.cor(data_df$price, data_df$transmission_Automatic, use = c("all.obs"))
print('the Point-Biserial Correlation for price and transmission_Manual is' )
biserial.cor(data_df$price, data_df$transmission_Manual, use = c("all.obs"))
print('the Point-Biserial Correlation for price and transmission_Semi.Auto is' )
biserial.cor(data_df$price, data_df$transmission_Semi.Auto, use = c("all.obs"))
print('the Point-Biserial Correlation for price and fuelType_Diesel is' )
biserial.cor(data_df$price, data_df$fuelType_Diesel, use = c("all.obs"))
print('the Point-Biserial Correlation for price and fuelType_Hybrid is' )
biserial.cor(data_df$price, data_df$fuelType_Hybrid, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Audi is' )
biserial.cor(data_df$price, data_df$Car.Make_Audi, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_BMW is' )
biserial.cor(data_df$price, data_df$Car.Make_BMW, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Ford is' )
biserial.cor(data_df$price, data_df$Car.Make_Ford, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Hyundai is' )
biserial.cor(data_df$price, data_df$Car.Make_Hyundai, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Mercedes is' )
biserial.cor(data_df$price, data_df$Car.Make_Mercedes, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Skoda is' )
biserial.cor(data_df$price, data_df$Car.Make_Skoda, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Toyota is' )
biserial.cor(data_df$price, data_df$Car.Make_Toyota, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Vauxhall is' )
biserial.cor(data_df$price, data_df$Car.Make_Vauxhall, use = c("all.obs"))
print('the Point-Biserial Correlation for price and Car.Make_Volkswagen is' )
biserial.cor(data_df$price, data_df$Car.Make_Volkswagen, use = c("all.obs"))
# there ddid not appear to be any high correlation between price and the categorical data
head(data_clean_cat)
```





```{r}
# create correlation plot of data 
# subset categorical data and quantiative data to check for correlation between price
library(ggcorrplot)
#loadPkg(ggcorrplot)
data_new_quant <- subset(df, select = c('year','price','mileage','tax','mpg','engineSize'))
corr_quant <- round(cor(data_new_quant), 1)
p.mat_quant <- cor_pmat(corr_quant, method = 'pearson')
ggcorrplot(corr_quant, hc.order=TRUE,lab = TRUE, p.mat = p.mat_quant)+ labs(title = "Correlation Plot of Quantiative data")
```


```{r}
# categorical data correlation plot 
data_clean_cat <- subset(df, select = c('model','price','transmission','fuelType','Car.Make'))
# make categorical data numeric
data_new_cat <- sapply(data_clean_cat, unclass)
corr_cat <- round(cor(data_new_cat), 1) 
p.mat_cat <- cor_pmat(corr_cat, method = 'spearman') # use Spearman correlation for large dataset of categorical features
ggcorrplot(corr_cat, hc.order=TRUE,p.mat=p.mat_cat, lab = TRUE) + labs(title = "Correlation Plot of Categorical data")

# cor(data_new_cat$price, data_new_cat$model,
#   method = "spearman"
# )

```

# Logistic Regression

```{r}
 quantile(data$price)
```

```{r}
# Add new Price_Range variable (Dependent Variable for Logistice Regression)
data<- data %>% mutate(Price_Range =
                     case_when(price <= 9999 ~  "Low", 
                               price > 9999 & price <= 14495 ~ "Medium",
                               price > 14495 & price <= 20870 ~ "High",
                               price > 20870  ~ "Luxury")
)
```

```{r}
# drop model and price
drops <- c("model")
#drops <- c("model","price")
data<- data[ , !(names(data) %in% drops)]
head(data)
```

```{r}
# One-hot encoding
library(mltools)
library(data.table)
data$year <- as.factor(data$year)

data_df <- as.data.frame(one_hot(as.data.table(data)))
drops <- c("transmission_Other","fuelType_Other", "fuelType_Electric", "Car.Make_Ford Focus", "Car.Make_Mercedes C Class")
data_df = data_df[ , !(names(data_df) %in% drops)]
#write.csv(data_df,"/Users/jakelieberfarb/Desktop/college/Grad (2021-2022)/Bayesian DS/Project/Clean_data.csv")
#data_df = subset(data_df, select = -c(transmission_Other,fuelType_Other, fuelType_Electric, Car.Make_Ford Focus, Car.Make_Mercedes C Class) )
head(data_df)
```


```{r}
require(rjags)
require(runjags)
y1 <- as.numeric(data$Price_Range=='Low')
y2 <- as.numeric(data$Price_Range=='Medium')
y3 <- as.numeric(data$Price_Range=='High')           
y4 <- as.numeric(data$Price_Range=='Luxury')
price_model <- "model{
  for(i in 1:N){
    y1[i] ~ dbern(p1[i])
    y2[i] ~ dbern(p2[i])
    y3[i] ~ dbern(p3[i])
    y4[i] ~ dbern(p4[i])
    
    logit(p1[i]) <- b0 + b1 * TA[i] +b2 * TM[i] +b3*TS[i]+ b4* Mileage[i] + b5*FD[i]  + b6 * FH[i] + b7 +FP[i] + b8 * tax[i] + b9* mpg[i] + b10 * engineSize[i] + b11*Y2008[i] +  b12*Y2009[i] + b13*Y2010[i] + b14*Y2011[i] + b15*Y2012[i] + b16*Y2013[i] + b17*Y2014[i] + b18*Y2015[i] + b19*Y2016[i]
    + b20*Y2017[i] + b21*Y2018[i] + b22*Y2019[i] + b23*Y2020[i] +  b24 * Audi[i] + b25 * BMW[i] + b26* Ford[i] + b27 * Hyundai[i] + b28 * Mercedes[i] + b29* Skoda[i] + b30* Toyota[i]+ b31 * Vauxhall[i] + b32 * Volkswagen[i] 
    
  
    logit(p2[i]) <- b0 + b1 * TA[i] +b2 * TM[i] +b3*TS[i]+ b4* Mileage[i] + b5*FD[i]  + b6 * FH[i] + b7 +FP[i] + b8 * tax[i] + b9* mpg[i] + b10 * engineSize[i] + b11*Y2008[i] +  b12*Y2009[i] + b13*Y2010[i] + b14*Y2011[i] + b15*Y2012[i] + b16*Y2013[i] + b17*Y2014[i] + b18*Y2015[i] + b19*Y2016[i]
    + b20*Y2017[i] + b21*Y2018[i] + b22*Y2019[i] + b23*Y2020[i] + b24 * Audi[i] + b25 * BMW[i] + b26* Ford[i] + b27 * Hyundai[i] + b28 * Mercedes[i] + b29* Skoda[i] + b30* Toyota[i]+ b31 * Vauxhall[i] + b32 * Volkswagen[i] 
    
  
   
  logit(p3[i]) <- b0 + b1 * TA[i] +b2 * TM[i] +b3*TS[i]+ b4* Mileage[i] + b5*FD[i]  + b6 * FH[i] + b7 +FP[i] + b8 * tax[i] + b9* mpg[i] + b10 * engineSize[i] + b11*Y2008[i] +  b12*Y2009[i] + b13*Y2010[i] + b14*Y2011[i] + b15*Y2012[i] + b16*Y2013[i] + b17*Y2014[i] + b18*Y2015[i] + b19*Y2016[i]
    + b20*Y2017[i] + b21*Y2018[i] + b22*Y2019[i] + b23*Y2020[i] +  b24 * Audi[i] + b25 * BMW[i] + b26* Ford[i] + b27 * Hyundai[i] + b28 * Mercedes[i] + b29* Skoda[i] + b30* Toyota[i]+ b31 * Vauxhall[i] + b32 * Volkswagen[i] 
  
  
    
  logit(p4[i]) <- b0 + b1 * TA[i] +b2 * TM[i] +b3*TS[i]+ b4* Mileage[i] + b5*FD[i]  + b6 * FH[i] + b7 +FP[i] + b8 * tax[i] + b9* mpg[i] + b10 * engineSize[i] + b11*Y2008[i] +  b12*Y2009[i] + b13*Y2010[i] + b14*Y2011[i] + b15*Y2012[i] + b16*Y2013[i] + b17*Y2014[i] + b18*Y2015[i] + b19*Y2016[i]
    + b20*Y2017[i] + b21*Y2018[i] + b22*Y2019[i] + b23*Y2020[i] +  b24 * Audi[i] + b25 * BMW[i] + b26* Ford[i] + b27 * Hyundai[i] + b28 * Mercedes[i] + b29* Skoda[i] + b30* Toyota[i]+ b31 * Vauxhall[i] + b32 * Volkswagen[i] 
  
  
  }
  b0 ~ dnorm(0, 10 ^ (-2))
  b1 ~ dnorm(0, 10 ^ (-2))
  b2 ~ dnorm(0, 10 ^ (-2))
  b3 ~ dnorm(0, 10 ^ (-2))
  b4 ~ dnorm(0, 10 ^ (-2))
  b5 ~ dnorm(0, 10 ^ (-2))
  b6 ~ dnorm(0, 10 ^ (-2))
  b7 ~ dnorm(0, 10 ^ (-2))
  b8 ~ dnorm(0, 10 ^ (-2))
  b9 ~ dnorm(0, 10 ^ (-2))
  b10 ~ dnorm(0, 10 ^ (-2))
  b11 ~ dnorm(0, 10 ^ (-2))
  b12 ~ dnorm(0, 10 ^ (-2))
  b13 ~ dnorm(0, 10 ^ (-2))
  b14 ~ dnorm(0, 10 ^ (-2))
  b15 ~ dnorm(0, 10 ^ (-2))
  b16 ~ dnorm(0, 10 ^ (-2))
  b17~ dnorm(0, 10 ^ (-2))
  b18 ~ dnorm(0, 10 ^ (-2))
  b19 ~ dnorm(0, 10 ^ (-2))
  b20~ dnorm(0, 10 ^ (-2))
  b21~ dnorm(0, 10 ^ (-2))
  b22~ dnorm(0, 10 ^ (-2))
  b23~ dnorm(0, 10 ^ (-2))
  b24 ~ dnorm(0, 10 ^ (-2))
  b25 ~ dnorm(0, 10 ^ (-2))
  b26 ~ dnorm(0, 10 ^ (-2))
  b27 ~ dnorm(0, 10 ^ (-2))
  b28 ~ dnorm(0, 10 ^ (-2))
  b29 ~ dnorm(0, 10 ^ (-2))
  b30 ~ dnorm(0, 10 ^ (-2))
  b31 ~ dnorm(0, 10 ^ (-2))
  b32 ~ dnorm(0, 10 ^ (-2))
}"
price_jags <- jags.model(textConnection(price_model), data = list(y1 =y1, y2=y2, y3=y3, y4=y4, 
                                                                  Y2008=data_df$year_2008,
                                                                  Y2009=data_df$year_2009,
                                                                  Y2010=data_df$year_2010,
                                                                  Y2011=data_df$year_2011,
                                                                  Y2012=data_df$year_2012,
                                                                  Y2013=data_df$year_2013,
                                                                  Y2014=data_df$year_2014,
                                                                  Y2015=data_df$year_2015,
                                                                  Y2016=data_df$year_2016,
                                                                  Y2017=data_df$year_2017,
                                                                  Y2018=data_df$year_2018,
                                                                  Y2019=data_df$year_2019,
                                                                  Y2020=data_df$year_2020,
                                                                  Audi= data_df$Car.Make_Audi,
                                                                  BMW= data_df$Car.Make_BMW,
                                                                  Ford= data_df$Car.Make_Ford,
                                                                  Hyundai= data_df$Car.Make_Hyundai,
                                                                  Mercedes= data_df$Car.Make_Mercedes,
                                                                  Skoda= data_df$Car.Make_Skoda,
                                                                  Toyota= data_df$Car.Make_Toyota,
                                                                  Vauxhall= data_df$Car.Make_Vauxhall,
                                                                  Volkswagen= data_df$Car.Make_Volkswagen,
                                                                  TA=data_df$transmission_Automatic,
                                                                  TM= data_df$transmission_Manual,
                                                                  TS=data_df$`transmission_Semi-Auto`,
                                                                  Mileage=data_df$mileage, FD= data_df$fuelType_Diesel
                                                                  , FH= data_df$fuelType_Hybrid, 
                                                                  FP= data_df$fuelType_Petrol, 
                                                                  tax= data_df$tax, mpg= data_df$mpg, 
                                                                  engineSize= data_df$engineSize,
                                                                  N=length(data), n.chains=3,
                   n.adapt=3000))


update(price_jags,  n.iter=1000,progress.bar = 'none')
price_sim <- coda.samples(price_jags, c("b0", "b1", "b2", "b3", "b4", "b5", "b6", "b7", "b8", "b9", "b10", "b11", "b12", "b13","b14", "b15", "b16", "b17", "b18", "b19", "b20", "b21", "b22", "b23", "b24", "b25", "b26", "b27", "b28", "b29", "b30", "b31", "b32"), n.iter=1000,
                        progress.bar = 'none')



#Results
Res <- do.call(rbind.data.frame, price_sim)

#summary(price_sim)
#pricemcmc <- data.frame(price_sim[[1]])
#head(pricemcmc, 3)

#m3 <- 1 / (1 + exp(-(pricemcmc$b0 + 3 * pricemcmc$b1)))
#plot(density(m3))
```

```{r}
plot(price_sim)
```



```{r}
Res

```

```{r}
print(list("bo", mean(Res$b0), sd(Res$b0)))
print(list("b1", mean(Res$b1), sd(Res$b1)))
print(list("b2", mean(Res$b2), sd(Res$b2)))
print(list("b3", mean(Res$b3), sd(Res$b3)))
print(list("b4", mean(Res$b4), sd(Res$b4)))
print(list("b5", mean(Res$b5), sd(Res$b5)))
print(list("b6", mean(Res$b6), sd(Res$b6)))
print(list("b7", mean(Res$b7), sd(Res$b7)))
print(list("b8", mean(Res$b8), sd(Res$b8)))
print(list("b9", mean(Res$b9), sd(Res$b9)))
print(list("b10", mean(Res$b10), sd(Res$b10)))
print(list("b11", mean(Res$b11), sd(Res$b11)))
print(list("b12", mean(Res$b12), sd(Res$b12)))
print(list("b13", mean(Res$b13), sd(Res$b13)))
print(list("b14", mean(Res$b14), sd(Res$b14)))
print(list("b15", mean(Res$b15), sd(Res$b15)))
print(list("b16", mean(Res$b16), sd(Res$b16)))
print(list("b17", mean(Res$b17), sd(Res$b17)))
print(list("b18", mean(Res$b18), sd(Res$b18)))
print(list("b19", mean(Res$b19), sd(Res$b19)))
print(list("b20", mean(Res$b20), sd(Res$b20)))
print(list("b21", mean(Res$b21), sd(Res$b21)))
print(list("b22", mean(Res$b22), sd(Res$b22)))
print(list("b23", mean(Res$b23), sd(Res$b23)))
print(list("b24", mean(Res$b24), sd(Res$b24)))
print(list("b25", mean(Res$b25), sd(Res$b25)))
print(list("b26", mean(Res$b26), sd(Res$b26)))
print(list("b27", mean(Res$b27), sd(Res$b27)))
print(list("b28", mean(Res$b28), sd(Res$b28)))
print(list("b29", mean(Res$b29), sd(Res$b29)))
print(list("b30", mean(Res$b30), sd(Res$b30)))
print(list("b31", mean(Res$b31), sd(Res$b31)))
print(list("b32", mean(Res$b32), sd(Res$b32)))




```






```{r}
summary(price_sim)
```

```{r}
pricemcmc <- data.frame(price_sim[[1]])
pricemcmc
```





```{r}

m3 <- 1 / (1 + exp(-(pricemcmc$b0 + 0 * pricemcmc$b1)))
plot(density(m3))
```



```{r}
m3
```



