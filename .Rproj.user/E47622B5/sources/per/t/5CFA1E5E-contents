# Predict.R
# This is the Solution file for Exercise 5 of course:
# Bayesian Computing for Data Science (DATS 6311, Summer 2020)
# Data Science @ George Washington University
# Author: Yuxiao Huang

# Reference:
# Some of the code is from the book by Professor John K. Kruschke
# Please find the reference to and website of the book below:
# Kruschke, J. K. (2014). Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and Stan. 2nd Edition. Academic Press / Elsevier
# https://sites.google.com/site/doingbayesiandataanalysis/
library(LaplacesDemon)

source("DBDA2E-utilities.R")

# Get the mcmc samples
# Here we assume that the samples have been generated by "Jags-Ymet-Xmet-Mrobust-Example.R"
# Implement me
codaSamples = get(load("Jags-Ymet-Xmet-Mrobust.Rdata"))
mcmcMat = as.matrix(codaSamples, chains = TRUE)

# Get the samples of the parameters
# Implement me
beta0 = mcmcMat[, "beta0"]
beta1 = mcmcMat[, "beta1"]
sigma = mcmcMat[, "sigma"]
nu = mcmcMat[, "nu"]

# Specify the testing data
xTest = 65
yTest = 145

# Get mu
# Implement me
mu = beta0 + beta1 * xTest
# Get yPred
# Implement me
yPred = rst(n=length(mu), mu=mu, sigma=sigma, nu=nu)

# Set up window and layout:
openGraph(width = 8, height = 5)

# Plot the distribution of yPred
histInfo = plotPost(yPred, showCurve=TRUE, xlab="yPred")

# Plot the yTest
points(yTest, 0, pch = "+", col = "red", cex = 3)

saveGraph(file = "Dist_yPred.pdf")
